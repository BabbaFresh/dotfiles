#!/bin/bash

SMB_HOST=""
SMB_USERNAME=""
SMB_PASSWORD=""
CONFIGFILE=$HOME/smbutils.json

if [ "$#" -ne 1 ]; then
  echo "Illegal number of arguments!"
  exit 1
fi

if [ -r $CONFIGFILE ]; then
  SMB_HOST=$(jq .host $CONFIGFILE | tr -d '"')
  SMB_USERNAME=$(jq .username $CONFIGFILE | tr -d '"')
else
  echo "Configfile does not exist: " $CONFIGFILE
  exit 2
fi




if [ "$1" = "list" ]; then
  smbclient --command 'print -' --user=$SMB_USERNAME --list=$SMB_HOST
  exit 0
fi




if [ "$1" = "mount" ]; then
  echo 'Enter SMB Location (e.g.: design): '
  read SMB_MOUNTPOINT
  echo ${SMB_HOST}
  SMB_MOUNTPATH=$HOME/SambaUtils/$SMB_MOUNTPOINT
  mkdir -p $SMB_MOUNTPATH
  sudo mount -t cifs //${SMB_HOST}/$SMB_MOUNTPOINT $SMB_MOUNTPATH -o username=${SMB_USERNAME}
fi




if [ "$1" = "unmount" ] || [ $1 = "umount" ]; then
  echo 'Enter Mountpoint (e.g.: design)'
  read SMB_MOUNTPOINT
    SMB_MOUNTPATH=$HOME/SambaUtils/$SMB_MOUNTPOINT
    sudo umount $SMB_MOUNTPATH
fi




if [ "$1" = "help" ]; then
  echo 'https://wiki.archlinux.de/title/Laufwerk_als_User_mounten#Mit_sudo'
fi
